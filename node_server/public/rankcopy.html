<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rank</title>

    <body>
      <script src="https://cdn.jsdelivr.net/npm/data-template@1.7/base.js"></script>

      <h1>RANK</h1>

      /////////////////////game_id=5/////////////////

      <div>1 Minute</div>
      <div
        class="table-row"
        id="articleList"
        data-template="article"
        data-bind="data"
      ></div>
      <template data-name="article">
        <div class="article">
          <div>username</div>
          <div data-text="username"></div>
          <div>score</div>
          <div data-text="user_score"></div>
          <div>time</div>
          <div data-text="time_spending"></div>
          <br /><br /><br /></div
      ></template>

      /////////////////////game_id=6/////////////////
      <!-- 
      <div>5 cup</div>
      <div
        class="table-row"
        id="articleList"
        data-template="article"
        data-bind="data"
      ></div>
      <template data-name="article">
        <div class="article">
          <div>username</div>
          <div data-text="username"></div>
          <div>score</div>
          <div data-text="user_score"></div>
          <div>time</div>
          <div data-text="time_spending"></div>
          <br /><br /><br /></div
      ></template> -->

      <script>
        async function loadrankList() {
          let res = await fetch("/gameRank");
          let json = await res.json();
          let data = json.data.map((record) => {
            if (record.time_spending) {
              return {
                id: record.id,
                username: record.username,
                userscore: record.userscore,
                game_id: record.game_id,
                time_spending: formateTime(record.time_spending),
              };
            }
            return record;
          });
          renderTemplate(articleList, { data });
        }
        loadrankList();

        function formateTime(time) {
          time = Number(time);
          var h = Math.floor(time / 3600);
          var m = Math.floor((time % 3600) / 60);
          var s = Math.floor((time % 3600) % 60);

          var hDisplay = h > 0 ? h + (h == 1 ? " hour, " : " hours, ") : "";
          var mDisplay = m > 0 ? m + (m == 1 ? " minute, " : " minutes, ") : "";
          var sDisplay = s > 0 ? s + (s == 1 ? " second" : " seconds") : "";
          return hDisplay + mDisplay + sDisplay;
        }

        console.log(formateTime(100));
      </script>
    </body>
  </head>
</html>
